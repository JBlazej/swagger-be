{"version":3,"sources":["../../src/services/auth.js"],"names":["payload","jwt","sign","secret","expiresIn","issueJsonWebToken","req","res","hasOwnProperty","headers","user","verify","status","json","error","msg","verifyJsonWebToken","process","env","NODE_ENV","JWT_SECRET"],"mappings":";;;;;;;;qEAIO,iBAAkCA,OAAlC;AAAA;AAAA;AAAA;AAAA;AAAA,6CACEC,uBAAIC,IAAJ,CAASF,OAAT,EAAkBG,MAAlB,EAA0B,EAAEC,WAAW,KAAb,EAA1B,CADF;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G;;kBAAeC,iB;;;;;;sEAIf,kBAAmCC,GAAnC,EAAwCC,GAAxC;AAAA;AAAA;AAAA;AAAA;AAAA,kBACDD,IAAIE,cAAJ,CAAmB,SAAnB,KAAiCF,IAAIG,OAAJ,CAAYD,cAAZ,CAA2B,eAA3B,CADhC;AAAA;AAAA;AAAA;;AAAA;;AAGDF,gBAAII,IAAJ,GAAWT,uBAAIU,MAAJ,CAAWL,IAAIG,OAAJ,CAAY,eAAZ,CAAX,EAAyC,QAAzC,CAAX;AAHC;AAAA;;AAAA;AAAA;AAAA;AAAA,8CAKMF,IAAIK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BC,qBAAO;AACLC,qBAAK;AADA;AADmB,aAArB,CALN;;AAAA;AAAA;AAAA;;AAAA;AAAA,8CAYIR,IAAIK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BC,qBAAO;AACLC,qBAAK;AADA;AADmB,aAArB,CAZJ;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G;;kBAAeC,kB;;;;;AARtB;;;;;;;;AAEA,IAAMb,SAASc,QAAQC,GAAR,CAAYC,QAAZ,KAAyB,YAAzB,GAAwCF,QAAQC,GAAR,CAAYE,UAApD,GAAiE,QAAhF","file":"auth.js","sourcesContent":["import jwt from 'jsonwebtoken'\n\nconst secret = process.env.NODE_ENV === 'production' ? process.env.JWT_SECRET : 'secret'\n\nexport async function issueJsonWebToken (payload) {\n  return jwt.sign(payload, secret, { expiresIn: 10800 })\n}\n\nexport async function verifyJsonWebToken (req, res) {\n  if( req.hasOwnProperty('headers') && req.headers.hasOwnProperty('authorization') ) {\n    try {\n      req.user = jwt.verify(req.headers['authorization'], 'secret')\n    } catch(err) {\n      return res.status(401).json({\n        error: {\n          msg: 'Failed to authenticate token!'\n        }\n      })\n    }\n  } else {\n    return res.status(401).json({\n      error: {\n        msg: 'No token!'\n      }\n    })\n  }\n \n  return\n}"]}